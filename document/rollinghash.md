[TOC]

# Rolling Hash

文字列，あるいは配列のハッシュ値を扱う構造体です．長さ $n$ の列に対して，前処理を $O(n)$ で行うことで連続部分列のハッシュ値を求めるクエリをそれぞれ $O(1)$ で処理できます．

また，このライブラリでは `uint64_t` のエイリアスとして `ull` を使います．ハッシュ値の型は `ull` です．ハッシュ値の法は $2^{64}$ になっています．

## コンストラクタ

```cpp
(1) RollingHash<b> d(string& s)
(2) RollingHash<b> d(vector<T>& v)
```

- (1) 文字列 `s` のハッシュテーブルを基数 `b` で初期化します．
- (2) 型 `T` の配列 `v` のハッシュテーブルを基数 `b` で初期化します．

基数に使う定数として `ull B998244353 = 998244353`，`ull B1000000007 = 1000000007` が用意されています．基数を指定しなかった場合，`B998244353` が基数になります．

以下，$n$ を列の長さとします．

**制約**

- $n \leq 10^8$

**計算量**

- $O(n)$

## get

```cpp
(1) ull get(int l, int r)
(2) ull get()
```

- (1): $[l, {\ }r)$ における連続部分列のハッシュ値を返します．
- (2): 列全体のハッシュ値を返します．

**制約**

- $0 \leq l \leq r \leq n$

**計算量**

- $O(1)$

## private変数，private関数

```cpp
int n;
vector<ull> hash;
vector<ull> powb;
void init(vector<ull>& v);
```

- `n` : 列の長さ
- `hash` : `hash[i+1]` は先頭から `i` 番目の要素までのハッシュ値
- `powb` : `powb[i]` は $b$ を基数として $b^i$
- `init` : 初期化するための関数

## RollingHash2D

```cpp
(1) RollingHash2D<br, bh> d(vector<string>& s, int h, int w)
(2) RollingHash2D<br, bh> d(vector<vector<T>>& v, int h, int w)
```

$2$ 次元配列における縦幅 $h$，横幅 $w$ の長方形のハッシュ値テーブルを作る構造体が付属しています．列方向の基数 `br` と行方向の基数 `bc` を指定して初期化します (指定しない場合 `br = B998244353, bc = B1000000007`)．$n$ を行数，$m$ を列数として初期化に$O(nm)$ かかります．`d[i][j]` で $(i, j)$ を左上の頂点とする長方形のハッシュ値を $O(1)$ 取得できます．